# 手表类蓝牙产品数据通信协议（精简版本Class.C）

为了满足如下需求设计此协议：

- 统一协议接口，使得研发、生产、测试和使用能够在统一的协议框架下进行。
- 提供一个具有后向兼容性的，可方便扩展，逻辑清晰的通用协议。
- 兼容BLE MTU为`20byte`的情形

## 需求定义

本设计所需满足的需求如下：

 - 易解析
 - 可扩展
 - 后向兼容
 - 流量控制（同步、异步）

## 最近修订历史
|    日期    | 备注                         |
| :--------: | :--------------------------- |
| 2018-11-28 | [v1.0.3](#!dev/changelog.md) |
| 2018-06-10 | [v1.0.1](#!dev/changelog.md) |
| 2017-10-29 | [v0.2.2](#!dev/changelog.md) |
| 2017-05-24 | [v0.2.1](#!dev/changelog.md) |
| 2016-05-29 | [v0.2](#!dev/changelog.md)   |


## 数据帧结构

| byte | 0           | 1      | 2~n     |
| :--: | :---------- | :----- | :------ |
| 内容 | flowcontrol | length | payload |

## 数据包内容

数据包包含如下内容(括号中为长度)：

- 流控信息`(1)`
- 数据包长度`(1)`
- 载荷`(0~18)`

### 流量控制
控制数据传输过程，提高传输可靠性，并完成差错控制。

### 数据包长度
定义当前数据包的长度。  

Hint: 当传输数据包长度超过MTU长度时，第一包长度字节写入完整长度，后续包的长度字节均写入`0xFF`，表示为前一包内容的延续。最多支持长度为`254`的数据帧。

### 载荷
数据载荷。

## 向后兼容
在两个设备建立连接时，需交流各自的版本。由移动端兼容设备端。

## [低功耗蓝牙接口](#!dev/classC/bt.md)

包含广播帧数据结构。使用的服务与特征的`uuid`和属性等信息。

## [设备信息列表](#!dev/classC/devices.md)

包含设备识别码对应的设备型号，以及外设配置和齿轮箱配置等参数。